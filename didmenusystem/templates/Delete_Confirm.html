{% extends 'base.html' %}
{% block content %}

<h1> DID Menu System - Create "DELETE-PseudoCID" & "Carrier-Cancelation" Files </h1>
<br><br>
<p> Create "PseudoCID Delete Files" & "Carrier Cancelation Form" for the following? </p>
    <form id="downloadForm" method="POST" action="{% url 'Create_Del_PseudoFile' %}">    
    {% csrf_token %}

    {% for instance in client_list_instances %}
        <input type="hidden" name="selected_pseudoCID" value="{{ instance.PseudoCID }}">
    {% endfor %}

    <table class="table table-striped table-hover table-bordered">
        <thead class="table-dark">
            <tr>
                <th scope="col">PseudoCID</th>
                <th scope="col">Client Description</th>
                <th scope="col">Total DID's</th>
                <th scope="col">Carrier</th>
            </tr>
        </thead>
        <tbody>
             {% if client_list_instances %}
                {% for instance in client_list_instances %}
                    <tr>            
                        <td>{{ instance.PseudoCID }}</td>
                        <td>{{ instance.Client_Description }}</td>
                        <td>{{ instance.DID_CNT }}</td>                    
                        <td>{{ instance.Carrier }}</td>
                    </tr>
                {% endfor %}
            {% endif %}
        </tbody>
    </table>
    <a href="{% url 'home' %}" class="btn btn-secondary">Cancel</a>
    <button type="button" id="downloadButton" class="btn btn-primary">Download 'DELETE-PseudoCID' & 'Carrier-Cancelation' Files</button>
    <a href="{% url 'Delete_Perform' %}" class="btn btn-secondary" id="finishButton">Finish</a>    
</form>

{% comment %} Java function to prevent pressing "Finish" prior to pressing "Download" button {% endcomment %}
<script>
    let downloadButtonClicked = false;

    document.getElementById('downloadButton').addEventListener('click', function() {
        downloadButtonClicked = true;
        document.getElementById('downloadForm').submit();
    });

    document.getElementById('finishButton').addEventListener('click', function(e) {
        if (!downloadButtonClicked) {
            e.preventDefault(); // Prevent the default behavior (form submission)
            alert("Must create 'DELETE-PseudoCID' & 'Carrier-Cancelation' files first!!");
            // Optionally show a message or perform other actions
        }
    });
</script>


{% endblock %}